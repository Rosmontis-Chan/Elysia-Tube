<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ’– Kawaii Video Downloader âœ¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom CSS untuk animasi dan warna yang lebih spesifik */
        body {
            font-family: 'Poppins', sans-serif; /* Ganti dengan font kawaii jika ada */
        }
        .bg-gradient-kawaii {
            background: linear-gradient(to bottom right, #e0ffe0, #ffffff); /* Hijau lembut ke putih */
        }
        .text-pink-kawaii {
            color: #ff85a2; /* Warna pink yang cute */
        }
        .drop-shadow-kawaii {
            filter: drop-shadow(0 4px 8px rgba(255, 133, 162, 0.3)); /* Shadow pink lembut */
        }
        .input-ribbon::before {
            content: 'ğŸ€';
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
        }
        .input-ribbon input {
            padding-left: 3rem; /* Ruang untuk pita */
        }

        /* Animasi Kustom (mirip tailwind.config.js sebelumnya) */
        @keyframes bounce-slow {
            0%, 100% { transform: translateY(-5%); }
            50% { transform: translateY(0); }
        }
        .animate-bounce-slow {
            animation: bounce-slow 4s infinite ease-in-out;
        }
        @keyframes fade-in {
            0% { opacity: 0; transform: translateY(10px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fade-in 0.5s ease-out forwards;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .7; }
        }
        .animate-pulse {
            animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body class="bg-gradient-kawaii min-h-screen flex flex-col items-center justify-center p-4">

    <header class="mb-8 text-center">
        <h1 class="text-5xl font-extrabold text-pink-kawaii drop-shadow-kawaii animate-bounce-slow">
            ğŸ’– Kawaii Video Downloader âœ¨
        </h1>
        <p class="text-green-600 text-lg mt-2 font-light">Unduh video dengan sentuhan kebahagiaan!</p>
    </header>

    <main class="bg-white p-8 rounded-3xl shadow-2xl border border-green-200 w-full max-w-2xl transform transition-all duration-300 hover:scale-105 hover:shadow-green-300/50">
        
        <form id="downloadForm" class="mb-6 flex flex-col sm:flex-row gap-4 items-center">
            <div class="relative flex-grow input-ribbon">
                <input
                    type="url"
                    id="videoUrl"
                    class="w-full p-4 rounded-full border-2 border-green-300 focus:border-green-500 focus:ring focus:ring-green-200 outline-none text-gray-700 text-lg shadow-inner-lg transition-all duration-200"
                    placeholder="Tempel URL Video Di Sini..."
                    required
                />
            </div>
            <button
                type="submit"
                id="downloadButton"
                class="bg-green-400 hover:bg-green-500 text-white font-bold py-4 px-8 rounded-full shadow-lg transform transition-all duration-200 hover:scale-105 active:scale-95 flex items-center justify-center space-x-2 text-lg whitespace-nowrap"
            >
                Unduh âœ¨
            </button>
        </form>

        <div id="loadingState" class="text-center my-8 animate-fade-in hidden">
            <img src="https://media.giphy.com/media/efNqG3K4t3O5h3eF4A/giphy.gif" 
                 alt="Cute Bear Loading" 
                 class="mx-auto w-32 h-32 object-contain filter drop-shadow-lg" />
            <p class="text-pink-500 mt-4 text-xl font-semibold animate-pulse">
                Beruang lucu sedang bekerja keras... ~_~
            </p>
        </div>

        <div id="errorState" class="bg-red-100 border-2 border-red-300 text-red-700 p-4 rounded-xl flex items-center justify-center space-x-3 shadow-md animate-fade-in my-6 hidden">
            <span role="img" aria-label="error" class="text-3xl">ğŸ˜¢</span>
            <p id="errorMessage" class="font-semibold text-lg"></p>
        </div>

        <div id="videoResult" class="mt-8 bg-green-50 p-6 rounded-2xl shadow-inner-lg border border-green-200 animate-fade-in hidden">
            <h2 class="text-3xl font-extrabold text-green-700 mb-6 border-b-2 border-green-300 pb-3">
                Video Siap Diunduh! ğŸ’–
            </h2>
            
            <div class="flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-6 mb-6">
                <img id="videoThumbnail" src="" alt="Video Thumbnail" class="w-48 h-auto rounded-xl shadow-lg border border-green-100 object-cover transform hover:scale-105 transition-transform duration-300 hidden" />
                <div>
                    <h3 id="videoTitle" class="text-2xl font-bold text-green-800 mb-2"></h3>
                    <p id="videoDescription" class="text-gray-600 text-md"></p>
                </div>
            </div>

            <div id="downloadFormats" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                </div>
        </div>

    </main>

    <footer class="mt-12 text-gray-500 text-center text-sm">
        <p>Dibuat dengan cinta fekuk video mitee kawaii! ğŸŒ¸</p>
    </footer>

    <script>
        // JavaScript untuk logika di sini
        const downloadForm = document.getElementById('downloadForm');
        const videoUrlInput = document.getElementById('videoUrl');
        const downloadButton = document.getElementById('downloadButton');
        const loadingState = document.getElementById('loadingState');
        const errorState = document.getElementById('errorState');
        const errorMessage = document.getElementById('errorMessage');
        const videoResult = document.getElementById('videoResult');
        const videoThumbnail = document.getElementById('videoThumbnail');
        const videoTitle = document.getElementById('videoTitle');
        const videoDescription = document.getElementById('videoDescription');
        const downloadFormats = document.getElementById('downloadFormats');

        // Ganti dengan URL API endpoint Anda yang akan menggunakan RapidAPI
        // NANTI KITA BUAT API INI
        const API_ENDPOINT = '/api/download-universal'; // Contoh endpoint Vercel Serverless Function

        downloadForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const url = videoUrlInput.value;

            // Reset tampilan
            loadingState.classList.add('hidden');
            errorState.classList.add('hidden');
            videoResult.classList.add('hidden');
            videoThumbnail.classList.add('hidden');
            downloadButton.disabled = true;
            downloadButton.innerHTML = '<span class="animate-spin mr-2">ğŸŒ¸</span> Memproses...';

            loadingState.classList.remove('hidden');

            try {
                // Panggil API backend yang Anda buat di Vercel Functions
                const response = await fetch(`${API_ENDPOINT}?url=${encodeURIComponent(url)}`);
                const data = await response.json();

                if (response.ok) {
                    loadingState.classList.add('hidden');
                    videoResult.classList.remove('hidden');

                    videoThumbnail.src = data.thumbnail;
                    videoThumbnail.alt = data.title;
                    videoThumbnail.classList.remove('hidden');
                    videoTitle.textContent = data.title;
                    videoDescription.textContent = data.description ? data.description.substring(0, 150) + '...' : 'Tidak ada deskripsi.';

                    downloadFormats.innerHTML = ''; // Kosongkan format sebelumnya
                    if (data.formats && data.formats.length > 0) {
                        data.formats.forEach(format => {
                            const formatLink = document.createElement('a');
                            formatLink.href = format.url;
                            formatLink.download = `${data.title}-${format.quality || format.container}.${format.container}`;
                            formatLink.target = '_blank';
                            formatLink.rel = 'noopener noreferrer';
                            formatLink.className = 'bg-green-300 hover:bg-green-400 text-green-800 font-semibold py-3 px-5 rounded-full shadow-md flex items-center justify-between transition-all duration-200 transform hover:scale-105 active:scale-95 text-lg';
                            formatLink.innerHTML = `<span>${format.quality || format.mimeType?.split('/')[0]} (${format.container || 'unknown'})</span><span class="text-xl">â¬‡ï¸</span>`;
                            downloadFormats.appendChild(formatLink);
                        });
                    } else {
                        downloadFormats.innerHTML = '<p class="text-gray-500 text-center">Tidak ada format unduhan yang tersedia. ğŸ˜”</p>';
                    }

                } else {
                    loadingState.classList.add('hidden');
                    errorState.classList.remove('hidden');
                    errorMessage.textContent = data.error || 'Terjadi kesalahan yang tidak diketahui. ğŸ˜¢';
                }
            } catch (err) {
                console.error('Error:', err);
                loadingState.classList.add('hidden');
                errorState.classList.remove('hidden');
                errorMessage.textContent = 'Gagal terhubung ke server. Coba lagi nanti. ğŸ˜”';
            } finally {
                downloadButton.disabled = false;
                downloadButton.innerHTML = 'Unduh âœ¨';
            }
        });
    </script>
</body>
</html>
